<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recycling & Zero Waste Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8ff;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        h1 {
            color: #2c7a7b;
        }

        #gameContainer {
            margin: 20px auto;
            max-width: 600px;
            background: #fff;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        #timer, #score {
            font-size: 1.2em;
            margin: 10px 0;
        }

        #question {
            margin: 20px 0;
        }

        button.option {
            display: block;
            width: 80%;
            margin: 10px auto;
            padding: 10px;
            border: none;
            border-radius: 10px;
            background-color: #2c7a7b;
            color: white;
            font-size: 1em;
            cursor: pointer;
        }

        button.option:hover {
            background-color: #285e61;
        }

        #popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            display: none;
        }

        #popupMessage {
            background: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            max-width: 80%;
        }
    </style>
</head>

<body>
    <div id="gameContainer">
        <h1>Recycling & Zero Waste Game</h1>
        <div id="timer">Time Left: 60s</div>
        <div id="score">Score: 0</div>
        <div id="question">Click start to begin!</div>
        <button id="startBtn">Start Game</button>
        <div id="options"></div>
    </div>

    <div id="popup">
        <div id="popupMessage"></div>
    </div>

    <script>
        const questions = [
            { question: "Which of these can be recycled?", options: ["Plastic bottle", "Food waste", "Ceramic plate", "Used tissue"], answer: "Plastic bottle" },
            { question: "What does the recycling symbol look like?", options: ["Three arrows in a triangle", "A tree", "A trash bin", "A leaf"], answer: "Three arrows in a triangle" },
            { question: "Which bin should organic waste go into?", options: ["Green", "Blue", "Black", "Red"], answer: "Green" },
            { question: "Which material is NOT recyclable?", options: ["Glass", "Aluminum", "Styrofoam", "Paper"], answer: "Styrofoam" },
            { question: "What does zero waste mean?", options: ["No trash at all", "Reducing waste by reusing and recycling", "Not using plastic", "Throwing everything away"], answer: "Reducing waste by reusing and recycling" }
        ];

        let score = 0;
        let currentQuestionIndex = 0;
        let timeLeft = 60;
        let timerInterval;
        let playerName = localStorage.getItem('playerName') || 'Unknown';
        let schoolName = localStorage.getItem('schoolName') || 'Unknown';
        let grade = localStorage.getItem('grade') || 'Unknown';

        document.getElementById("startBtn").addEventListener("click", startGame);

        function startGame() {
            score = 0;
            currentQuestionIndex = 0;
            timeLeft = 60;
            document.getElementById("score").textContent = `Score: ${score}`;
            document.getElementById("startBtn").style.display = 'none';
            showQuestion();
            timerInterval = setInterval(updateTimer, 1000);
        }

        function showQuestion() {
            if (currentQuestionIndex >= questions.length) {
                endGame("You've answered all questions!");
                return;
            }

            const currentQuestion = questions[currentQuestionIndex];
            document.getElementById("question").textContent = currentQuestion.question;

            const optionsContainer = document.getElementById("options");
            optionsContainer.innerHTML = '';

            currentQuestion.options.forEach(option => {
                const button = document.createElement("button");
                button.textContent = option;
                button.classList.add("option");
                button.onclick = () => checkAnswer(option);
                optionsContainer.appendChild(button);
            });
        }

        function checkAnswer(selectedOption) {
            if (selectedOption === questions[currentQuestionIndex].answer) {
                score += 10;
            } else {
                score -= 5;
            }

            document.getElementById("score").textContent = `Score: ${score}`;
            currentQuestionIndex++;
            showQuestion();
        }

        function updateTimer() {
            timeLeft--;
            document.getElementById("timer").textContent = `Time Left: ${timeLeft}s`;
            if (timeLeft <= 0) {
                endGame("Time's up!");
            }
        }

        function endGame(message) {
            clearInterval(timerInterval);
            showPopup(message + `\n\nYour final score: ${score}`);
            localStorage.setItem('recycleScore', score);
            localStorage.setItem('gamePlayed', 'true');

            const recycleLeaderboard = JSON.parse(localStorage.getItem('recycleLeaderboard') || '[]');
            recycleLeaderboard.push({
                name: playerName,
                school: schoolName,
                grade: grade,
                score: score
            });
            recycleLeaderboard.sort((a, b) => b.score - a.score);
            localStorage.setItem('recycleLeaderboard', JSON.stringify(recycleLeaderboard.slice(0, 5)));

            // Send score to main leaderboard for index.html
            const mainLeaderboard = JSON.parse(localStorage.getItem('mainLeaderboard') || '[]');
            mainLeaderboard.push({
                name: playerName,
                school: schoolName,
                grade: grade,
                score: score,
                game: "Recycling & Zero Waste"
            });
            mainLeaderboard.sort((a, b) => b.score - a.score);
            localStorage.setItem('mainLeaderboard', JSON.stringify(mainLeaderboard.slice(0, 5)));

            setTimeout(() => {
                window.location.href = "../index.html";
            }, 3000);
        }

        function showPopup(message) {
            document.getElementById("popupMessage").textContent = message;
            document.getElementById("popup").style.display = "flex";
        }
    </script>
</body>

</html>
